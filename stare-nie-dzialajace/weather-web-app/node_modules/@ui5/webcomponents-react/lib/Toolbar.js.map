{"version":3,"file":"Toolbar.js","sources":["../src/internal/stopPropagation.ts","../src/components/Toolbar/OverflowPopover.tsx","../src/components/Toolbar/Toolbar.jss.ts","../src/components/Toolbar/index.tsx"],"sourcesContent":["export const stopPropagation = (e) => {\n  e.stopPropagation();\n  e.stopImmediatePropagation();\n};\n","import '@ui5/webcomponents-icons/dist/icons/overflow';\nimport { ThemingParameters } from '@ui5/webcomponents-react-base/lib/ThemingParameters';\nimport { ButtonDesign } from '@ui5/webcomponents-react/lib/ButtonDesign';\nimport { PlacementType } from '@ui5/webcomponents-react/lib/PlacementType';\nimport { Popover } from '@ui5/webcomponents-react/lib/Popover';\nimport { ToggleButton } from '@ui5/webcomponents-react/lib/ToggleButton';\nimport React, { FC, ReactElement, ReactNode, useCallback, useEffect, useRef, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { Ui5PopoverDomRef } from '../../interfaces/Ui5PopoverDomRef';\nimport { stopPropagation } from '../../internal/stopPropagation';\n\ninterface OverflowPopoverProps {\n  lastVisibleIndex: number;\n  contentClass: string;\n  children: ReactNode;\n}\n\nexport const OverflowPopover: FC<OverflowPopoverProps> = (props: OverflowPopoverProps) => {\n  const { lastVisibleIndex, contentClass, children } = props;\n  const popoverRef = useRef<Ui5PopoverDomRef>();\n  const [pressed, setPressed] = useState(false);\n\n  const handleToggleButtonClick = useCallback((e) => {\n    if (popoverRef.current) {\n      if (!pressed) {\n        popoverRef.current.openBy(e.target);\n        setPressed(true);\n      } else {\n        popoverRef.current.close();\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    return () => {\n      if (popoverRef.current) {\n        popoverRef.current.close();\n      }\n    };\n  }, []);\n\n  const handleClose = useCallback(\n    (e) => {\n      stopPropagation(e);\n      setPressed(false);\n    },\n    [setPressed]\n  );\n\n  const renderChildren = useCallback(() => {\n    return React.Children.toArray(\n      (children as ReactElement)?.type === React.Fragment ? (children as ReactElement).props.children : children\n    ).map((item: ReactElement<any>, index) => {\n      if (index > lastVisibleIndex) {\n        if ((item.type as any).displayName === 'ToolbarSeparator') {\n          return React.cloneElement(item, {\n            style: {\n              height: '0.0625rem',\n              margin: '0.375rem 0.1875rem',\n              width: '100%',\n              background: ThemingParameters.sapToolbar_SeparatorColor\n            }\n          });\n        }\n        return item;\n      }\n      return null;\n    });\n  }, [children, lastVisibleIndex]);\n\n  return (\n    <>\n      <ToggleButton\n        design={ButtonDesign.Transparent}\n        icon=\"overflow\"\n        onClick={handleToggleButtonClick}\n        pressed={pressed}\n      />\n      {createPortal(\n        <Popover placementType={PlacementType.Bottom} ref={popoverRef} onAfterClose={handleClose}>\n          <div className={contentClass}>{renderChildren()}</div>\n        </Popover>,\n        document.body\n      )}\n    </>\n  );\n};\n","import { ThemingParameters } from '@ui5/webcomponents-react-base/lib/ThemingParameters';\nimport { CssSizeVariables } from '@ui5/webcomponents-react-base/lib/CssSizeVariables';\n\nexport const styles = {\n  outerContainer: {\n    width: '100%',\n    height: CssSizeVariables.sapWcrToolbarHeight,\n    position: 'relative',\n    overflow: 'hidden',\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    borderBottom: `solid 0.0625rem ${ThemingParameters.sapGroup_TitleBorderColor}`\n  },\n  hasOverflow: {\n    '& $toolbar': {\n      maxWidth: 'calc(100% - 44px)'\n    }\n  },\n  clear: {\n    borderBottom: 'none'\n  },\n  active: {\n    cursor: 'pointer',\n    '&:active': {\n      backgroundColor: ThemingParameters.sapActiveColor\n    },\n    '&:hover': {\n      backgroundColor: ThemingParameters.sapList_Hover_Background\n    }\n  },\n  info: {\n    // This color is most similar to darken(@sapUiBaseColor, 10)\n    backgroundColor: ThemingParameters.sapList_HeaderBorderColor,\n    '&$active': {\n      backgroundColor: ThemingParameters.sapInfobar_Active_Background,\n      '&:active': {\n        backgroundColor: `${ThemingParameters.sapInfobar_Active_Background}`\n      },\n      '&:hover': {\n        backgroundColor: ThemingParameters.sapInfobar_Hover_Background\n      }\n    }\n  },\n  solid: {\n    backgroundColor: ThemingParameters.sapBackgroundColor\n  },\n  transparent: {\n    backgroundColor: ThemingParameters.sapToolbar_Background\n  },\n  toolbar: {\n    width: '100%',\n    '& >:first-child:not(.spacer)': {\n      margin: '0 0.25rem 0 0'\n    },\n    '& >:last-child:not(.spacer)': {\n      margin: '0 0.5rem 0 0.25rem'\n    },\n    '& > *:not(first-child):not(last-child):not(.spacer)': {\n      margin: '0 0.25rem'\n    },\n    display: 'flex',\n    alignItems: 'center',\n    maxWidth: '100%'\n  },\n  overflowButtonContainer: {\n    marginRight: '0.5rem'\n  },\n  popoverContent: {\n    maxWidth: '20rem',\n    padding: CssSizeVariables.sapWcrToolbarPopoverContentPadding,\n    display: 'flex',\n    flexDirection: 'column'\n  }\n};\n","import { createComponentStyles } from '@ui5/webcomponents-react-base/lib/createComponentStyles';\nimport { useConsolidatedRef, useI18nText } from '@ui5/webcomponents-react-base/lib/hooks';\nimport { StyleClassHelper } from '@ui5/webcomponents-react-base/lib/StyleClassHelper';\nimport { usePassThroughHtmlProps } from '@ui5/webcomponents-react-base/lib/usePassThroughHtmlProps';\nimport { enrichEventWithDetails } from '@ui5/webcomponents-react-base/lib/Utils';\nimport { SHOW_MORE } from '@ui5/webcomponents-react/dist/assets/i18n/i18n-defaults';\nimport { CommonProps } from '@ui5/webcomponents-react/interfaces/CommonProps';\nimport { ToolbarDesign } from '@ui5/webcomponents-react/lib/ToolbarDesign';\nimport { ToolbarStyle } from '@ui5/webcomponents-react/lib/ToolbarStyle';\nimport React, {\n  createRef,\n  FC,\n  forwardRef,\n  ReactElement,\n  ReactNode,\n  ReactNodeArray,\n  Ref,\n  RefObject,\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useRef,\n  useState\n} from 'react';\nimport { OverflowPopover } from './OverflowPopover';\nimport { styles } from './Toolbar.jss';\n\nconst useStyles = createComponentStyles(styles, { name: 'Toolbar' });\n\nexport interface ToolbarProptypes extends CommonProps {\n  children?: ReactNode | ReactNodeArray;\n  toolbarStyle?: ToolbarStyle;\n  design?: ToolbarDesign;\n  active?: boolean;\n  onToolbarClick?: (event: CustomEvent) => void;\n}\n\nconst Toolbar: FC<ToolbarProptypes> = forwardRef((props: ToolbarProptypes, ref: Ref<HTMLDivElement>) => {\n  const { children, toolbarStyle, design, active, style, tooltip, className, onToolbarClick, slot } = props;\n  const classes = useStyles(styles);\n  const outerContainer: RefObject<HTMLDivElement> = useConsolidatedRef(ref);\n  const controlMetaData = useRef([]);\n  const [lastVisibleIndex, setLastVisibleIndex] = useState<number>(null);\n\n  const passThroughProps = usePassThroughHtmlProps(props, ['onToolbarClick']);\n\n  const [showMoreText] = useI18nText('@ui5/webcomponents-react', SHOW_MORE);\n\n  const toolbarClasses = StyleClassHelper.of(classes.outerContainer);\n  if (toolbarStyle === ToolbarStyle.Clear) {\n    toolbarClasses.put(classes.clear);\n  }\n  if (active) {\n    toolbarClasses.put(classes.active);\n  }\n  switch (design) {\n    case ToolbarDesign.Solid:\n      toolbarClasses.put(classes.solid);\n      break;\n    case ToolbarDesign.Transparent:\n      toolbarClasses.put(classes.transparent);\n      break;\n    case ToolbarDesign.Info:\n      toolbarClasses.put(classes.info);\n      break;\n    default:\n      break;\n  }\n  toolbarClasses.putIfPresent(className);\n\n  const childrenWithRef = useMemo(() => {\n    controlMetaData.current = [];\n\n    return React.Children.toArray(\n      (children as ReactElement)?.type === React.Fragment ? (children as ReactElement).props.children : children\n    ).map((item: ReactElement, index) => {\n      const itemRef: RefObject<HTMLDivElement> = createRef();\n\n      controlMetaData.current.push({\n        ref: itemRef\n      });\n\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      if ((item?.type as any)?.displayName === 'ToolbarSpacer') {\n        return item;\n      }\n      return (\n        <div ref={itemRef} key={index}>\n          {item}\n        </div>\n      );\n    });\n  }, [children, controlMetaData]);\n  const overflowNeeded =\n    (lastVisibleIndex || lastVisibleIndex === 0) && React.Children.count(childrenWithRef) !== lastVisibleIndex + 1;\n\n  toolbarClasses.putIfPresent(overflowNeeded && classes.hasOverflow);\n\n  const calculateVisibleItems = useCallback(() => {\n    const OVERFLOW_BUTTON_WIDTH = 32 + 8;\n    requestAnimationFrame(() => {\n      if (!outerContainer.current) return;\n      const availableWidth = outerContainer.current.getBoundingClientRect().width;\n      let consumedWidth = 0;\n      let lastIndex = null;\n      let lastFitWidth = 0;\n\n      if (availableWidth - OVERFLOW_BUTTON_WIDTH <= 0) {\n        lastIndex = -1;\n        lastFitWidth = 0;\n      } else {\n        controlMetaData.current.forEach((item, index) => {\n          const currentMeta = controlMetaData.current[index] as { ref: RefObject<HTMLElement> };\n          if (currentMeta && currentMeta.ref && currentMeta.ref.current) {\n            let nextWidth = currentMeta.ref.current.getBoundingClientRect().width;\n            nextWidth += index === 0 || index === controlMetaData.current.length - 1 ? 4 : 8; //first & last element = padding: 4px\n            if (index === controlMetaData.current.length - 1) {\n              if (consumedWidth + nextWidth <= availableWidth - 8) {\n                lastIndex = index;\n                lastFitWidth = consumedWidth + nextWidth;\n              }\n            } else {\n              if (consumedWidth + nextWidth <= availableWidth - OVERFLOW_BUTTON_WIDTH) {\n                lastIndex = index;\n                lastFitWidth = consumedWidth + nextWidth;\n              }\n              if (\n                consumedWidth < availableWidth - OVERFLOW_BUTTON_WIDTH &&\n                consumedWidth + nextWidth >= availableWidth - OVERFLOW_BUTTON_WIDTH\n              ) {\n                lastIndex = index - 1;\n                lastFitWidth = 0;\n              }\n            }\n            consumedWidth += nextWidth;\n          }\n        });\n      }\n      setLastVisibleIndex(lastIndex);\n    });\n  }, [outerContainer.current, controlMetaData.current, setLastVisibleIndex, childrenWithRef, overflowNeeded]);\n\n  const observer = useRef(new ResizeObserver(calculateVisibleItems));\n\n  useEffect(() => {\n    if (outerContainer.current) {\n      observer.current.observe(outerContainer.current);\n    }\n    return () => {\n      observer.current.disconnect();\n    };\n  }, [outerContainer.current]);\n\n  useLayoutEffect(() => {\n    calculateVisibleItems();\n  }, [calculateVisibleItems]);\n\n  const onClick = useCallback(\n    (e) => {\n      if (active && typeof onToolbarClick === 'function') {\n        onToolbarClick(enrichEventWithDetails(e));\n      }\n    },\n    [onToolbarClick, active]\n  );\n\n  return (\n    <div\n      title={tooltip}\n      style={style}\n      className={toolbarClasses.className}\n      ref={outerContainer}\n      onClick={onClick}\n      slot={slot}\n      {...passThroughProps}\n    >\n      <div className={classes.toolbar}>\n        {overflowNeeded &&\n          React.Children.map(childrenWithRef, (item, index) => {\n            if (index >= lastVisibleIndex + 1) {\n              return React.cloneElement(item as ReactElement, { style: { visibility: 'hidden' } });\n            }\n            return item;\n          })}\n        {!overflowNeeded && childrenWithRef}\n      </div>\n      {overflowNeeded && (\n        <div className={classes.overflowButtonContainer} title={showMoreText}>\n          <OverflowPopover lastVisibleIndex={lastVisibleIndex} contentClass={classes.popoverContent}>\n            {children}\n          </OverflowPopover>\n        </div>\n      )}\n    </div>\n  );\n});\n\nToolbar.defaultProps = {\n  toolbarStyle: ToolbarStyle.Standard,\n  design: ToolbarDesign.Auto,\n  active: false\n};\n\nToolbar.displayName = 'Toolbar';\nexport { Toolbar };\n"],"names":["stopPropagation","e","stopImmediatePropagation","OverflowPopover","props","lastVisibleIndex","contentClass","children","popoverRef","useRef","useState","pressed","setPressed","handleToggleButtonClick","useCallback","current","openBy","target","close","useEffect","handleClose","renderChildren","React","Children","toArray","type","Fragment","map","item","index","displayName","cloneElement","style","height","margin","width","background","ThemingParameters","sapToolbar_SeparatorColor","ButtonDesign","Transparent","createPortal","PlacementType","Bottom","document","body","styles","outerContainer","CssSizeVariables","sapWcrToolbarHeight","position","overflow","display","justifyContent","alignItems","borderBottom","sapGroup_TitleBorderColor","hasOverflow","maxWidth","clear","active","cursor","backgroundColor","sapActiveColor","sapList_Hover_Background","info","sapList_HeaderBorderColor","sapInfobar_Active_Background","sapInfobar_Hover_Background","solid","sapBackgroundColor","transparent","sapToolbar_Background","toolbar","overflowButtonContainer","marginRight","popoverContent","padding","sapWcrToolbarPopoverContentPadding","flexDirection","useStyles","createComponentStyles","name","Toolbar","forwardRef","ref","toolbarStyle","design","tooltip","className","onToolbarClick","slot","classes","useConsolidatedRef","controlMetaData","setLastVisibleIndex","passThroughProps","usePassThroughHtmlProps","useI18nText","SHOW_MORE","showMoreText","toolbarClasses","StyleClassHelper","of","ToolbarStyle","Clear","put","ToolbarDesign","Solid","Info","putIfPresent","childrenWithRef","useMemo","itemRef","createRef","push","overflowNeeded","count","calculateVisibleItems","OVERFLOW_BUTTON_WIDTH","requestAnimationFrame","availableWidth","getBoundingClientRect","consumedWidth","lastIndex","forEach","currentMeta","nextWidth","length","observer","ResizeObserver","observe","disconnect","useLayoutEffect","onClick","enrichEventWithDetails","visibility","defaultProps","Standard","Auto"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAO,IAAMA,eAAe,GAAG,SAAlBA,eAAkB,CAACC,CAAD,EAAO;AACpCA,EAAAA,CAAC,CAACD,eAAF;AACAC,EAAAA,CAAC,CAACC,wBAAF;AACD,CAHM;;ACiBA,IAAMC,eAAyC,GAAG,SAA5CA,eAA4C,CAACC,KAAD,EAAiC;AAAA,MAChFC,gBADgF,GACnCD,KADmC,CAChFC,gBADgF;AAAA,MAC9DC,YAD8D,GACnCF,KADmC,CAC9DE,YAD8D;AAAA,MAChDC,QADgD,GACnCH,KADmC,CAChDG,QADgD;AAExF,MAAMC,UAAU,GAAGC,MAAM,EAAzB;;AAFwF,kBAG1DC,QAAQ,CAAC,KAAD,CAHkD;AAAA;AAAA,MAGjFC,OAHiF;AAAA,MAGxEC,UAHwE;;AAKxF,MAAMC,uBAAuB,GAAGC,WAAW,CAAC,UAACb,CAAD,EAAO;AACjD,QAAIO,UAAU,CAACO,OAAf,EAAwB;AACtB,UAAI,CAACJ,OAAL,EAAc;AACZH,QAAAA,UAAU,CAACO,OAAX,CAAmBC,MAAnB,CAA0Bf,CAAC,CAACgB,MAA5B;AACAL,QAAAA,UAAU,CAAC,IAAD,CAAV;AACD,OAHD,MAGO;AACLJ,QAAAA,UAAU,CAACO,OAAX,CAAmBG,KAAnB;AACD;AACF;AACF,GAT0C,EASxC,EATwC,CAA3C;AAWAC,EAAAA,SAAS,CAAC,YAAM;AACd,WAAO,YAAM;AACX,UAAIX,UAAU,CAACO,OAAf,EAAwB;AACtBP,QAAAA,UAAU,CAACO,OAAX,CAAmBG,KAAnB;AACD;AACF,KAJD;AAKD,GANQ,EAMN,EANM,CAAT;AAQA,MAAME,WAAW,GAAGN,WAAW,CAC7B,UAACb,CAAD,EAAO;AACLD,IAAAA,eAAe,CAACC,CAAD,CAAf;AACAW,IAAAA,UAAU,CAAC,KAAD,CAAV;AACD,GAJ4B,EAK7B,CAACA,UAAD,CAL6B,CAA/B;AAQA,MAAMS,cAAc,GAAGP,WAAW,CAAC,YAAM;AACvC,WAAOQ,KAAK,CAACC,QAAN,CAAeC,OAAf,CACL,CAACjB,QAAD,aAACA,QAAD,uBAACA,QAAD,CAA4BkB,IAA5B,MAAqCH,KAAK,CAACI,QAA3C,GAAuDnB,QAAD,CAA2BH,KAA3B,CAAiCG,QAAvF,GAAkGA,QAD7F,EAELoB,GAFK,CAED,UAACC,IAAD,EAA0BC,KAA1B,EAAoC;AACxC,UAAIA,KAAK,GAAGxB,gBAAZ,EAA8B;AAC5B,YAAKuB,IAAI,CAACH,IAAN,CAAmBK,WAAnB,KAAmC,kBAAvC,EAA2D;AACzD,8BAAOR,KAAK,CAACS,YAAN,CAAmBH,IAAnB,EAAyB;AAC9BI,YAAAA,KAAK,EAAE;AACLC,cAAAA,MAAM,EAAE,WADH;AAELC,cAAAA,MAAM,EAAE,oBAFH;AAGLC,cAAAA,KAAK,EAAE,MAHF;AAILC,cAAAA,UAAU,EAAEC,iBAAiB,CAACC;AAJzB;AADuB,WAAzB,CAAP;AAQD;;AACD,eAAOV,IAAP;AACD;;AACD,aAAO,IAAP;AACD,KAjBM,CAAP;AAkBD,GAnBiC,EAmB/B,CAACrB,QAAD,EAAWF,gBAAX,CAnB+B,CAAlC;AAqBA,sBACE,uDACE,oBAAC,YAAD;AACE,IAAA,MAAM,EAAEkC,YAAY,CAACC,WADvB;AAEE,IAAA,IAAI,EAAC,UAFP;AAGE,IAAA,OAAO,EAAE3B,uBAHX;AAIE,IAAA,OAAO,EAAEF;AAJX,IADF,eAOG8B,YAAY,eACX,oBAAC,OAAD;AAAS,IAAA,aAAa,EAAEC,aAAa,CAACC,MAAtC;AAA8C,IAAA,GAAG,EAAEnC,UAAnD;AAA+D,IAAA,YAAY,EAAEY;AAA7E,kBACE;AAAK,IAAA,SAAS,EAAEd;AAAhB,KAA+Be,cAAc,EAA7C,CADF,CADW,EAIXuB,QAAQ,CAACC,IAJE,CAPf,CADF;AAgBD,CArEM;;ACdA,IAAMC,MAAM,GAAG;AACpBC,EAAAA,cAAc,EAAE;AACdZ,IAAAA,KAAK,EAAE,MADO;AAEdF,IAAAA,MAAM,EAAEe,gBAAgB,CAACC,mBAFX;AAGdC,IAAAA,QAAQ,EAAE,UAHI;AAIdC,IAAAA,QAAQ,EAAE,QAJI;AAKdC,IAAAA,OAAO,EAAE,MALK;AAMdC,IAAAA,cAAc,EAAE,eANF;AAOdC,IAAAA,UAAU,EAAE,QAPE;AAQdC,IAAAA,YAAY,4BAAqBlB,iBAAiB,CAACmB,yBAAvC;AARE,GADI;AAWpBC,EAAAA,WAAW,EAAE;AACX,kBAAc;AACZC,MAAAA,QAAQ,EAAE;AADE;AADH,GAXO;AAgBpBC,EAAAA,KAAK,EAAE;AACLJ,IAAAA,YAAY,EAAE;AADT,GAhBa;AAmBpBK,EAAAA,MAAM,EAAE;AACNC,IAAAA,MAAM,EAAE,SADF;AAEN,gBAAY;AACVC,MAAAA,eAAe,EAAEzB,iBAAiB,CAAC0B;AADzB,KAFN;AAKN,eAAW;AACTD,MAAAA,eAAe,EAAEzB,iBAAiB,CAAC2B;AAD1B;AALL,GAnBY;AA4BpBC,EAAAA,IAAI,EAAE;AACJ;AACAH,IAAAA,eAAe,EAAEzB,iBAAiB,CAAC6B,yBAF/B;AAGJ,gBAAY;AACVJ,MAAAA,eAAe,EAAEzB,iBAAiB,CAAC8B,4BADzB;AAEV,kBAAY;AACVL,QAAAA,eAAe,YAAKzB,iBAAiB,CAAC8B,4BAAvB;AADL,OAFF;AAKV,iBAAW;AACTL,QAAAA,eAAe,EAAEzB,iBAAiB,CAAC+B;AAD1B;AALD;AAHR,GA5Bc;AAyCpBC,EAAAA,KAAK,EAAE;AACLP,IAAAA,eAAe,EAAEzB,iBAAiB,CAACiC;AAD9B,GAzCa;AA4CpBC,EAAAA,WAAW,EAAE;AACXT,IAAAA,eAAe,EAAEzB,iBAAiB,CAACmC;AADxB,GA5CO;AA+CpBC,EAAAA,OAAO,EAAE;AACPtC,IAAAA,KAAK,EAAE,MADA;AAEP,oCAAgC;AAC9BD,MAAAA,MAAM,EAAE;AADsB,KAFzB;AAKP,mCAA+B;AAC7BA,MAAAA,MAAM,EAAE;AADqB,KALxB;AAQP,2DAAuD;AACrDA,MAAAA,MAAM,EAAE;AAD6C,KARhD;AAWPkB,IAAAA,OAAO,EAAE,MAXF;AAYPE,IAAAA,UAAU,EAAE,QAZL;AAaPI,IAAAA,QAAQ,EAAE;AAbH,GA/CW;AA8DpBgB,EAAAA,uBAAuB,EAAE;AACvBC,IAAAA,WAAW,EAAE;AADU,GA9DL;AAiEpBC,EAAAA,cAAc,EAAE;AACdlB,IAAAA,QAAQ,EAAE,OADI;AAEdmB,IAAAA,OAAO,EAAE7B,gBAAgB,CAAC8B,kCAFZ;AAGd1B,IAAAA,OAAO,EAAE,MAHK;AAId2B,IAAAA,aAAa,EAAE;AAJD;AAjEI,CAAf;;ACyBP,IAAMC,SAAS,GAAGC,qBAAqB,CAACnC,MAAD,EAAS;AAAEoC,EAAAA,IAAI,EAAE;AAAR,CAAT,CAAvC;IAUMC,OAA6B,gBAAGC,UAAU,CAAC,UAAChF,KAAD,EAA0BiF,GAA1B,EAAuD;AAAA,MAC9F9E,QAD8F,GACFH,KADE,CAC9FG,QAD8F;AAAA,MACpF+E,YADoF,GACFlF,KADE,CACpFkF,YADoF;AAAA,MACtEC,MADsE,GACFnF,KADE,CACtEmF,MADsE;AAAA,MAC9D3B,MAD8D,GACFxD,KADE,CAC9DwD,MAD8D;AAAA,MACtD5B,KADsD,GACF5B,KADE,CACtD4B,KADsD;AAAA,MAC/CwD,OAD+C,GACFpF,KADE,CAC/CoF,OAD+C;AAAA,MACtCC,SADsC,GACFrF,KADE,CACtCqF,SADsC;AAAA,MAC3BC,cAD2B,GACFtF,KADE,CAC3BsF,cAD2B;AAAA,MACXC,IADW,GACFvF,KADE,CACXuF,IADW;AAEtG,MAAMC,OAAO,GAAGZ,SAAS,CAAClC,MAAD,CAAzB;AACA,MAAMC,cAAyC,GAAG8C,kBAAkB,CAACR,GAAD,CAApE;AACA,MAAMS,eAAe,GAAGrF,MAAM,CAAC,EAAD,CAA9B;;AAJsG,kBAKtDC,QAAQ,CAAS,IAAT,CAL8C;AAAA;AAAA,MAK/FL,gBAL+F;AAAA,MAK7E0F,mBAL6E;;AAOtG,MAAMC,gBAAgB,GAAGC,uBAAuB,CAAC7F,KAAD,EAAQ,CAAC,gBAAD,CAAR,CAAhD;;AAPsG,qBAS/E8F,WAAW,CAAC,0BAAD,EAA6BC,SAA7B,CAToE;AAAA;AAAA,MAS/FC,YAT+F;;AAWtG,MAAMC,cAAc,GAAGC,gBAAgB,CAACC,EAAjB,CAAoBX,OAAO,CAAC7C,cAA5B,CAAvB;;AACA,MAAIuC,YAAY,KAAKkB,YAAY,CAACC,KAAlC,EAAyC;AACvCJ,IAAAA,cAAc,CAACK,GAAf,CAAmBd,OAAO,CAACjC,KAA3B;AACD;;AACD,MAAIC,MAAJ,EAAY;AACVyC,IAAAA,cAAc,CAACK,GAAf,CAAmBd,OAAO,CAAChC,MAA3B;AACD;;AACD,UAAQ2B,MAAR;AACE,SAAKoB,aAAa,CAACC,KAAnB;AACEP,MAAAA,cAAc,CAACK,GAAf,CAAmBd,OAAO,CAACvB,KAA3B;AACA;;AACF,SAAKsC,aAAa,CAACnE,WAAnB;AACE6D,MAAAA,cAAc,CAACK,GAAf,CAAmBd,OAAO,CAACrB,WAA3B;AACA;;AACF,SAAKoC,aAAa,CAACE,IAAnB;AACER,MAAAA,cAAc,CAACK,GAAf,CAAmBd,OAAO,CAAC3B,IAA3B;AACA;AATJ;;AAaAoC,EAAAA,cAAc,CAACS,YAAf,CAA4BrB,SAA5B;AAEA,MAAMsB,eAAe,GAAGC,OAAO,CAAC,YAAM;AACpClB,IAAAA,eAAe,CAAC/E,OAAhB,GAA0B,EAA1B;AAEA,WAAOO,KAAK,CAACC,QAAN,CAAeC,OAAf,CACL,CAACjB,QAAD,aAACA,QAAD,uBAACA,QAAD,CAA4BkB,IAA5B,MAAqCH,KAAK,CAACI,QAA3C,GAAuDnB,QAAD,CAA2BH,KAA3B,CAAiCG,QAAvF,GAAkGA,QAD7F,EAELoB,GAFK,CAED,UAACC,IAAD,EAAqBC,KAArB,EAA+B;AAAA;;AACnC,UAAMoF,OAAkC,gBAAGC,SAAS,EAApD;AAEApB,MAAAA,eAAe,CAAC/E,OAAhB,CAAwBoG,IAAxB,CAA6B;AAC3B9B,QAAAA,GAAG,EAAE4B;AADsB,OAA7B,EAHmC;;AAQnC,UAAI,CAACrF,IAAD,aAACA,IAAD,qCAACA,IAAI,CAAEH,IAAP,0DAAqBK,WAArB,MAAqC,eAAzC,EAA0D;AACxD,eAAOF,IAAP;AACD;;AACD,0BACE;AAAK,QAAA,GAAG,EAAEqF,OAAV;AAAmB,QAAA,GAAG,EAAEpF;AAAxB,SACGD,IADH,CADF;AAKD,KAlBM,CAAP;AAmBD,GAtB8B,EAsB5B,CAACrB,QAAD,EAAWuF,eAAX,CAtB4B,CAA/B;AAuBA,MAAMsB,cAAc,GAClB,CAAC/G,gBAAgB,IAAIA,gBAAgB,KAAK,CAA1C,KAAgDiB,KAAK,CAACC,QAAN,CAAe8F,KAAf,CAAqBN,eAArB,MAA0C1G,gBAAgB,GAAG,CAD/G;AAGAgG,EAAAA,cAAc,CAACS,YAAf,CAA4BM,cAAc,IAAIxB,OAAO,CAACnC,WAAtD;AAEA,MAAM6D,qBAAqB,GAAGxG,WAAW,CAAC,YAAM;AAC9C,QAAMyG,qBAAqB,GAAG,KAAK,CAAnC;AACAC,IAAAA,qBAAqB,CAAC,YAAM;AAC1B,UAAI,CAACzE,cAAc,CAAChC,OAApB,EAA6B;AAC7B,UAAM0G,cAAc,GAAG1E,cAAc,CAAChC,OAAf,CAAuB2G,qBAAvB,GAA+CvF,KAAtE;AACA,UAAIwF,aAAa,GAAG,CAApB;AACA,UAAIC,SAAS,GAAG,IAAhB;;AAGA,UAAIH,cAAc,GAAGF,qBAAjB,IAA0C,CAA9C,EAAiD;AAC/CK,QAAAA,SAAS,GAAG,CAAC,CAAb;AAED,OAHD,MAGO;AACL9B,QAAAA,eAAe,CAAC/E,OAAhB,CAAwB8G,OAAxB,CAAgC,UAACjG,IAAD,EAAOC,KAAP,EAAiB;AAC/C,cAAMiG,WAAW,GAAGhC,eAAe,CAAC/E,OAAhB,CAAwBc,KAAxB,CAApB;;AACA,cAAIiG,WAAW,IAAIA,WAAW,CAACzC,GAA3B,IAAkCyC,WAAW,CAACzC,GAAZ,CAAgBtE,OAAtD,EAA+D;AAC7D,gBAAIgH,SAAS,GAAGD,WAAW,CAACzC,GAAZ,CAAgBtE,OAAhB,CAAwB2G,qBAAxB,GAAgDvF,KAAhE;AACA4F,YAAAA,SAAS,IAAIlG,KAAK,KAAK,CAAV,IAAeA,KAAK,KAAKiE,eAAe,CAAC/E,OAAhB,CAAwBiH,MAAxB,GAAiC,CAA1D,GAA8D,CAA9D,GAAkE,CAA/E,CAF6D;;AAG7D,gBAAInG,KAAK,KAAKiE,eAAe,CAAC/E,OAAhB,CAAwBiH,MAAxB,GAAiC,CAA/C,EAAkD;AAChD,kBAAIL,aAAa,GAAGI,SAAhB,IAA6BN,cAAc,GAAG,CAAlD,EAAqD;AACnDG,gBAAAA,SAAS,GAAG/F,KAAZ;AAED;AACF,aALD,MAKO;AACL,kBAAI8F,aAAa,GAAGI,SAAhB,IAA6BN,cAAc,GAAGF,qBAAlD,EAAyE;AACvEK,gBAAAA,SAAS,GAAG/F,KAAZ;AAED;;AACD,kBACE8F,aAAa,GAAGF,cAAc,GAAGF,qBAAjC,IACAI,aAAa,GAAGI,SAAhB,IAA6BN,cAAc,GAAGF,qBAFhD,EAGE;AACAK,gBAAAA,SAAS,GAAG/F,KAAK,GAAG,CAApB;AAED;AACF;;AACD8F,YAAAA,aAAa,IAAII,SAAjB;AACD;AACF,SAzBD;AA0BD;;AACDhC,MAAAA,mBAAmB,CAAC6B,SAAD,CAAnB;AACD,KAvCoB,CAArB;AAwCD,GA1CwC,EA0CtC,CAAC7E,cAAc,CAAChC,OAAhB,EAAyB+E,eAAe,CAAC/E,OAAzC,EAAkDgF,mBAAlD,EAAuEgB,eAAvE,EAAwFK,cAAxF,CA1CsC,CAAzC;AA4CA,MAAMa,QAAQ,GAAGxH,MAAM,CAAC,IAAIyH,cAAJ,CAAmBZ,qBAAnB,CAAD,CAAvB;AAEAnG,EAAAA,SAAS,CAAC,YAAM;AACd,QAAI4B,cAAc,CAAChC,OAAnB,EAA4B;AAC1BkH,MAAAA,QAAQ,CAAClH,OAAT,CAAiBoH,OAAjB,CAAyBpF,cAAc,CAAChC,OAAxC;AACD;;AACD,WAAO,YAAM;AACXkH,MAAAA,QAAQ,CAAClH,OAAT,CAAiBqH,UAAjB;AACD,KAFD;AAGD,GAPQ,EAON,CAACrF,cAAc,CAAChC,OAAhB,CAPM,CAAT;AASAsH,EAAAA,eAAe,CAAC,YAAM;AACpBf,IAAAA,qBAAqB;AACtB,GAFc,EAEZ,CAACA,qBAAD,CAFY,CAAf;AAIA,MAAMgB,OAAO,GAAGxH,WAAW,CACzB,UAACb,CAAD,EAAO;AACL,QAAI2D,MAAM,IAAI,OAAO8B,cAAP,KAA0B,UAAxC,EAAoD;AAClDA,MAAAA,cAAc,CAAC6C,sBAAsB,CAACtI,CAAD,CAAvB,CAAd;AACD;AACF,GALwB,EAMzB,CAACyF,cAAD,EAAiB9B,MAAjB,CANyB,CAA3B;AASA,sBACE;AACE,IAAA,KAAK,EAAE4B,OADT;AAEE,IAAA,KAAK,EAAExD,KAFT;AAGE,IAAA,SAAS,EAAEqE,cAAc,CAACZ,SAH5B;AAIE,IAAA,GAAG,EAAE1C,cAJP;AAKE,IAAA,OAAO,EAAEuF,OALX;AAME,IAAA,IAAI,EAAE3C;AANR,KAOMK,gBAPN,gBASE;AAAK,IAAA,SAAS,EAAEJ,OAAO,CAACnB;AAAxB,KACG2C,cAAc,IACb9F,KAAK,CAACC,QAAN,CAAeI,GAAf,CAAmBoF,eAAnB,EAAoC,UAACnF,IAAD,EAAOC,KAAP,EAAiB;AACnD,QAAIA,KAAK,IAAIxB,gBAAgB,GAAG,CAAhC,EAAmC;AACjC,0BAAOiB,KAAK,CAACS,YAAN,CAAmBH,IAAnB,EAAyC;AAAEI,QAAAA,KAAK,EAAE;AAAEwG,UAAAA,UAAU,EAAE;AAAd;AAAT,OAAzC,CAAP;AACD;;AACD,WAAO5G,IAAP;AACD,GALD,CAFJ,EAQG,CAACwF,cAAD,IAAmBL,eARtB,CATF,EAmBGK,cAAc,iBACb;AAAK,IAAA,SAAS,EAAExB,OAAO,CAAClB,uBAAxB;AAAiD,IAAA,KAAK,EAAE0B;AAAxD,kBACE,oBAAC,eAAD;AAAiB,IAAA,gBAAgB,EAAE/F,gBAAnC;AAAqD,IAAA,YAAY,EAAEuF,OAAO,CAAChB;AAA3E,KACGrE,QADH,CADF,CApBJ,CADF;AA6BD,CA9J+C;AAgKhD4E,OAAO,CAACsD,YAAR,GAAuB;AACrBnD,EAAAA,YAAY,EAAEkB,YAAY,CAACkC,QADN;AAErBnD,EAAAA,MAAM,EAAEoB,aAAa,CAACgC,IAFD;AAGrB/E,EAAAA,MAAM,EAAE;AAHa,CAAvB;AAMAuB,OAAO,CAACrD,WAAR,GAAsB,SAAtB;;;;"}