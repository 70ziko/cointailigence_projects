{"version":3,"file":"Device.js","sources":["../src/Device/Support.ts","../src/Device/utils.ts","../src/Device/MediaEventProvider.ts","../src/Device/Media.ts","../src/Device/index.ts"],"sourcesContent":["export const supportPointerEvents = () => {\n  return 'onpointerdown' in window;\n};\n\nexport const supportInputPlaceholder = () => {\n  return 'placeholder' in document.createElement('input') && 'placeholder' in document.createElement('textarea');\n};\n\nexport const supportWebSocket = () => {\n  let isSupported = false;\n  try {\n    isSupported = 'WebSocket' in window && window.WebSocket.CLOSING === 2;\n  } catch (e) {\n    // do nothing\n  }\n  return isSupported;\n};\n\nexport const supportMatchMedia = () => {\n  return 'matchMedia' in window;\n};\n\nexport const supportMatchMediaListener = () => {\n  return !!(supportMatchMedia() && window.matchMedia('all and (max-width:0px)'));\n};\n\nexport const supportOrientation = () => {\n  return 'DeviceOrientationEvent' in window;\n};\n\nexport const supportRetina = () => {\n  return (window as any).retina || window.devicePixelRatio >= 2;\n};\n","import { getOS, supportTouch } from '@ui5/webcomponents-base/dist/Device';\nimport { supportMatchMedia, supportOrientation } from './Support';\n\nexport const getWindowSize = () => {\n  return [window.innerWidth, window.innerHeight];\n};\n\nexport const changeRootCSSClass = (sClassName, bRemove, sPrefix?) => {\n  const oRoot = document.documentElement;\n  if (oRoot.className.length === 0) {\n    if (!bRemove) {\n      oRoot.className = sClassName;\n    }\n  } else {\n    const aCurrentClasses = oRoot.className.split(' ');\n    let sNewClasses = '';\n    aCurrentClasses.forEach((currentClass) => {\n      // eslint-disable-next-line @typescript-eslint/prefer-string-starts-ends-with\n      if ((sPrefix && currentClass.indexOf(sPrefix) !== 0) || (!sPrefix && currentClass !== sClassName)) {\n        sNewClasses = `${sNewClasses + currentClass} `;\n      }\n    });\n    if (!bRemove) {\n      sNewClasses += sClassName;\n    }\n    oRoot.className = sNewClasses;\n  }\n};\n\nexport const getQuery = (from: number, to: number, unit = 'px') => {\n  let q = 'all';\n  if (from > 0) {\n    q = `${q} and (min-width:${from}${unit})`;\n  }\n  if (to > 0) {\n    q = `${q} and (max-width:${to}${unit})`;\n  }\n  return q;\n};\n\nexport const convertToPx = (val, unit?) => {\n  if (unit === 'em' || unit === 'rem') {\n    const s = window.getComputedStyle ?? ((element: any) => element.currentStyle);\n    const x = s(document.documentElement).fontSize;\n    const f = x && x.indexOf('px') >= 0 ? parseFloat(x) : 16;\n    return val * f;\n  }\n  return val;\n};\n\nexport const matchLegacyBySize = (from, to, unit, size) => {\n  from = convertToPx(from, unit);\n  to = convertToPx(to, unit);\n\n  const width = size[0];\n  const a = from < 0 || from <= width;\n  const b = to < 0 || width <= to;\n  return a && b;\n};\n\nexport const isLandscape = (bFromOrientationChange: boolean, orientation, bKeyboardOpen: boolean) => {\n  if (supportTouch() && supportOrientation() && getOS().android) {\n    // if on screen keyboard is open and the call of this method is from orientation change listener,\n    // reverse the last value. this is because when keyboard opens on android device, the height can be less\n    // than the width even in portrait mode.\n    if (bKeyboardOpen && bFromOrientationChange) {\n      return !orientation.landscape;\n    }\n    if (bKeyboardOpen) {\n      // when keyboard opens, the last orientation change value will be returned.\n      return orientation.landscape;\n    }\n  } else if (supportMatchMedia() && supportOrientation()) {\n    // most desktop browsers and windows phone/tablet which not support orientationchange\n    return !!window.matchMedia('(orientation: landscape)').matches;\n  }\n  // otherwise compare the width and height of window\n  const size = getWindowSize();\n  return size[0] > size[1];\n};\n","import EventProvider from '@ui5/webcomponents-base/dist/EventProvider';\n\nexport const MediaEventProvider = new EventProvider();\n","import { Logger } from '@ui5/webcomponents-react-base/lib/Logger';\nimport { MediaEventProvider } from './MediaEventProvider';\nimport { supportMatchMediaListener } from './Support';\nimport { changeRootCSSClass, getQuery, matchLegacyBySize } from './utils';\n\ninterface Query {\n  media?: MediaQueryList;\n  query: string;\n  from: number;\n  to: number;\n}\n\ninterface RangeInfo {\n  from: number;\n  to: number;\n  name: string;\n  unit: string;\n}\n\ninterface RangeSet {\n  points: number[];\n  unit: string;\n  name: string;\n  names: string[];\n\n  noClasses?: boolean;\n  queries?: Query[];\n  timer?: number;\n  currentquery?: Query;\n  listener?: () => void;\n}\n\nconst eventProvider = MediaEventProvider;\n\n// private helpers\nconst initializedQuerySets: Record<string, RangeSet> = {};\n\nconst refreshCSSClasses = (sSetName: string, sRangeName: string, bRemove?: boolean) => {\n  const sClassPrefix = `sapUiMedia-${sSetName}-`;\n  changeRootCSSClass(sClassPrefix + sRangeName, bRemove, sClassPrefix);\n};\n\nconst getRangeInfo = (sSetName, iRangeIdx) => {\n  const q = initializedQuerySets[sSetName].queries[iRangeIdx];\n  const info = { from: q.from, unit: initializedQuerySets[sSetName].unit } as any;\n  if (q.to >= 0) {\n    info.to = q.to;\n  }\n  if (initializedQuerySets[sSetName].names) {\n    info.name = initializedQuerySets[sSetName].names[iRangeIdx];\n  }\n  return info;\n};\n\nconst matches = (from, to, unit) => {\n  const q = getQuery(from, to, unit);\n  const mm = window.matchMedia(q); // FF returns null when running within an iframe with display:none\n  return mm && mm.matches;\n};\n\nconst checkQueries = (name: string, infoOnly, fnMatches = matches): RangeInfo => {\n  if (initializedQuerySets[name]) {\n    const aQueries = initializedQuerySets[name].queries;\n    let info = null;\n    for (let i = 0, len = aQueries.length; i < len; i++) {\n      const q = aQueries[i];\n      if (\n        (q !== initializedQuerySets[name].currentquery || infoOnly) &&\n        fnMatches(q.from, q.to, initializedQuerySets[name].unit)\n      ) {\n        if (!infoOnly) {\n          initializedQuerySets[name].currentquery = q;\n        }\n        if (!initializedQuerySets[name].noClasses && initializedQuerySets[name].names && !infoOnly) {\n          refreshCSSClasses(name, initializedQuerySets[name].names[i]);\n        }\n        info = getRangeInfo(name, i);\n      }\n    }\n\n    return info;\n  }\n  Logger.warning(`No queryset with name ${name} found`, 'DEVICE.MEDIA');\n  return null;\n};\n\nconst handleChange = (name: string): void => {\n  if (initializedQuerySets[name].timer) {\n    clearTimeout(initializedQuerySets[name].timer);\n    initializedQuerySets[name].timer = null;\n  }\n\n  initializedQuerySets[name].timer = (setTimeout(\n    () => {\n      const mParams = checkQueries(name, false);\n      if (mParams) {\n        eventProvider.fireEvent(`media_${name}`, mParams);\n      }\n    },\n    supportMatchMediaListener() ? 0 : 100\n  ) as unknown) as number;\n};\n\n// public API\n\nexport enum RANGESETS {\n  SAP_3STEPS = '3Step',\n  SAP_4STEPS = '4Step',\n  SAP_6STEPS = '6Step',\n  SAP_STANDARD = 'Std',\n  SAP_STANDARD_EXTENDED = 'StdExt'\n}\n\nexport const DEFAULT_RANGE_SET = RANGESETS.SAP_STANDARD;\n\nexport const DEFAULT_RANGESETS: Record<string, RangeSet> = {\n  [RANGESETS.SAP_3STEPS]: {\n    points: [520, 960],\n    unit: 'px',\n    name: RANGESETS.SAP_3STEPS,\n    names: ['S', 'M', 'L']\n  },\n  [RANGESETS.SAP_4STEPS]: {\n    points: [520, 760, 960],\n    unit: 'px',\n    name: RANGESETS.SAP_4STEPS,\n    names: ['S', 'M', 'L', 'XL']\n  },\n  [RANGESETS.SAP_6STEPS]: {\n    points: [241, 400, 541, 768, 960],\n    unit: 'px',\n    name: RANGESETS.SAP_6STEPS,\n    names: ['XS', 'S', 'M', 'L', 'XL', 'XXL']\n  },\n  [RANGESETS.SAP_STANDARD]: {\n    points: [600, 1024],\n    unit: 'px',\n    name: RANGESETS.SAP_STANDARD,\n    names: ['Phone', 'Tablet', 'Desktop']\n  },\n  [RANGESETS.SAP_STANDARD_EXTENDED]: {\n    points: [600, 1024, 1440],\n    unit: 'px',\n    name: RANGESETS.SAP_STANDARD_EXTENDED,\n    names: ['Phone', 'Tablet', 'Desktop', 'LargeDesktop']\n  }\n};\n\nexport const hasRangeSet = (sName: string): boolean => {\n  return sName && !!initializedQuerySets[sName];\n};\n\nexport const getCurrentRange = (rangeSetName: string, width: number): RangeInfo => {\n  if (!initializedQuerySets[DEFAULT_RANGE_SET]) {\n    initRangeSet();\n  }\n  if (!initializedQuerySets[RANGESETS.SAP_STANDARD_EXTENDED]) {\n    initRangeSet(RANGESETS.SAP_STANDARD_EXTENDED);\n  }\n\n  if (!hasRangeSet(rangeSetName)) {\n    return null;\n  }\n  return checkQueries(\n    rangeSetName,\n    true,\n    isNaN(width) ? null : (from, to, unit) => matchLegacyBySize(from, to, unit, [width, 0])\n  );\n};\n\nexport const initRangeSet = (\n  sName?: string,\n  aRangeBorders?: number[],\n  sUnit?: string,\n  aRangeNames?: string[],\n  bSuppressClasses?: boolean\n): void => {\n  let oConfig: RangeSet;\n  if (!sName) {\n    oConfig = DEFAULT_RANGESETS[DEFAULT_RANGE_SET];\n  } else if (sName && DEFAULT_RANGESETS[sName]) {\n    oConfig = DEFAULT_RANGESETS[sName];\n  } else {\n    oConfig = {\n      name: sName,\n      unit: (sUnit || 'px').toLowerCase(),\n      points: aRangeBorders || [],\n      names: aRangeNames,\n      noClasses: !!bSuppressClasses\n    };\n  }\n\n  if (hasRangeSet(oConfig.name)) {\n    return;\n  }\n\n  sName = oConfig.name;\n  oConfig.queries = [];\n  oConfig.timer = null;\n  oConfig.currentquery = null;\n  oConfig.listener = () => handleChange(sName);\n\n  const aPoints = oConfig.points;\n  for (let i = 0, len = aPoints.length; i <= len; i++) {\n    const from = i === 0 ? 0 : aPoints[i - 1];\n    const to = i === aPoints.length ? -1 : aPoints[i];\n    const query = getQuery(from, to, oConfig.unit);\n    oConfig.queries.push({\n      query,\n      from,\n      to\n    });\n  }\n\n  if (oConfig.names && oConfig.names.length !== oConfig.queries.length) {\n    oConfig.names = null;\n  }\n\n  initializedQuerySets[oConfig.name] = oConfig;\n\n  const queries = oConfig.queries;\n  for (const q of queries) {\n    q.media = window.matchMedia(q.query);\n    q.media.addListener(oConfig.listener);\n  }\n\n  oConfig.listener();\n};\n\nexport const removeRangeSet = (rangeSetName: string): void => {\n  if (!hasRangeSet(rangeSetName)) {\n    Logger.info(`RangeSet ${rangeSetName} not found, thus could not be removed.`, 'DEVICE.MEDIA');\n    return;\n  }\n\n  for (const x in RANGESETS) {\n    if (rangeSetName === RANGESETS[x]) {\n      Logger.warning('Cannot remove default rangeset - no action taken.', 'DEVICE.MEDIA');\n      return;\n    }\n  }\n\n  const oConfig = initializedQuerySets[rangeSetName];\n  // FF, Safari, Chrome, IE10?\n  const queries = oConfig.queries;\n  for (const q of queries) {\n    q.media.removeListener(oConfig.listener);\n  }\n\n  refreshCSSClasses(rangeSetName, '', true);\n  // eslint-disable-next-line no-underscore-dangle\n  delete eventProvider._eventRegistry[`media_${rangeSetName}`];\n  delete initializedQuerySets[rangeSetName];\n};\n\nexport const attachMediaHandler = (fnFunction, name: string = DEFAULT_RANGE_SET): void => {\n  eventProvider.attachEvent(`media_${name}`, fnFunction);\n};\n\nexport const detachMediaHandler = (fnFunction, name: string = DEFAULT_RANGE_SET): void => {\n  eventProvider.detachEvent(`media_${name}`, fnFunction);\n};\n","import '@ui5/webcomponents-react-base/types/UI5Device.d.ts';\nimport { getOS, getSystem, supportTouch } from '@ui5/webcomponents-base/dist/Device';\nimport EventProvider from '@ui5/webcomponents-base/dist/EventProvider';\nimport { supportOrientation } from './Support';\nimport * as Utils from './utils';\n\nconst eventProvider = new EventProvider();\n\nlet iResizeTimeout;\nlet bOrientationChange = false;\nlet bResize = false;\nlet iOrientationTimeout;\nlet iClearFlagTimeout;\nlet [iWindowWidthOld, iWindowHeightOld] = Utils.getWindowSize();\nlet bKeyboardOpen = false;\nlet iLastResizeTime;\nconst rInputTagRegex = /INPUT|TEXTAREA|SELECT/;\n\ninterface IOrientation {\n  landscape: boolean;\n  portrait: boolean;\n}\n\ninterface IWindowSize {\n  height: number;\n  width: number;\n}\n\nconst internalWindowSize: IWindowSize = {\n  height: 0,\n  width: 0\n};\n\nconst internalOrientation: IOrientation = {\n  landscape: false,\n  portrait: false\n};\n\n// PRIVATE API\n\nconst setResizeInfo = () => {\n  internalWindowSize.width = Utils.getWindowSize()[0];\n  internalWindowSize.height = Utils.getWindowSize()[1];\n};\n\nconst setOrientationInfo = () => {\n  internalOrientation.landscape = Utils.isLandscape(true, internalOrientation, bKeyboardOpen);\n  internalOrientation.portrait = !internalOrientation.landscape;\n};\n\nconst clearFlags = () => {\n  bOrientationChange = false;\n  bResize = false;\n  iClearFlagTimeout = null;\n};\n\nlet eventListenersInitialized = false;\nconst initEventListeners = () => {\n  // Add handler for orientationchange and resize after initialization of Device API\n  if (supportTouch() && supportOrientation()) {\n    // logic for mobile devices which support orientationchange (like ios, android)\n    window.addEventListener('resize', handleMobileOrientationResizeChange, false);\n    window.addEventListener('orientationchange', handleMobileOrientationResizeChange, false);\n  } else {\n    // desktop browsers and windows phone/tablet which not support orientationchange\n    window.addEventListener('resize', handleResizeEvent, false);\n  }\n  setResizeInfo();\n  setOrientationInfo();\n  eventListenersInitialized = true;\n};\n\n// orientation change\nconst handleOrientationChange = () => {\n  setOrientationInfo();\n  eventProvider.fireEvent('orientation', {\n    landscape: internalOrientation.landscape,\n    portrait: internalOrientation.portrait\n  });\n};\n\nconst handleMobileTimeout = () => {\n  // with ios split view, the browser fires only resize event and no orientationchange\n  // when changing the size of a split view\n  // therefore the following if needs to be adapted with additional check of iPad with version greater or equal 9\n  // (splitview was introduced with iOS 9)\n  if (bResize && (bOrientationChange || (getSystem().tablet && getOS().ios && getOS().version >= 9))) {\n    handleOrientationChange();\n    handleResizeChange();\n    bOrientationChange = false;\n    bResize = false;\n    if (iClearFlagTimeout) {\n      window.clearTimeout(iClearFlagTimeout);\n      iClearFlagTimeout = null;\n    }\n  }\n  iOrientationTimeout = null;\n};\n\nconst handleMobileOrientationResizeChange = (evt) => {\n  if (evt.type === 'resize') {\n    if (rInputTagRegex.test(document.activeElement.tagName) && !bOrientationChange) {\n      return;\n    }\n\n    const [iWindowWidthNew, iWindowHeightNew] = Utils.getWindowSize();\n    const iTime = new Date().getTime();\n    // skip multiple resize events by only one orientationchange\n    if (iWindowHeightNew === iWindowHeightOld && iWindowWidthNew === iWindowWidthOld) {\n      return;\n    }\n    bResize = true;\n    // on mobile devices opening the keyboard on some devices leads to a resize event\n    // in this case only the height changes, not the width\n    if (iWindowHeightOld !== iWindowHeightNew && iWindowWidthOld === iWindowWidthNew) {\n      // Asus Transformer tablet fires two resize events when orientation changes while keyboard is open.\n      // Between these two events, only the height changes. The check of if keyboard is open has to be skipped because\n      // it may be judged as keyboard closed but the keyboard is still\n      // open which will affect the orientation detection\n      if (!iLastResizeTime || iTime - iLastResizeTime > 300) {\n        bKeyboardOpen = iWindowHeightNew < iWindowHeightOld;\n      }\n      handleResizeChange();\n    } else {\n      iWindowWidthOld = iWindowWidthNew;\n    }\n    iLastResizeTime = iTime;\n    iWindowHeightOld = iWindowHeightNew;\n\n    if (iClearFlagTimeout) {\n      window.clearTimeout(iClearFlagTimeout);\n      iClearFlagTimeout = null;\n    }\n    // Some Android build-in browser fires a resize event after the viewport is applied.\n    // This resize event has to be dismissed otherwise when the next orientationchange event happens,\n    // a UI5 resize event will be fired with the wrong window size.\n    iClearFlagTimeout = window.setTimeout(clearFlags, 1200);\n  } else if (evt.type === 'orientationchange') {\n    bOrientationChange = true;\n  }\n\n  if (iOrientationTimeout) {\n    clearTimeout(iOrientationTimeout);\n    iOrientationTimeout = null;\n  }\n  iOrientationTimeout = window.setTimeout(handleMobileTimeout, 50);\n};\n\n// RESIZE ONLY WITHOUT ORIENTATION CHANGE\nconst handleResizeChange = () => {\n  setResizeInfo();\n  eventProvider.fireEvent('resize', {\n    height: internalWindowSize.height,\n    width: internalWindowSize.width\n  });\n};\n\nconst handleResizeTimeout = () => {\n  handleResizeChange();\n  iResizeTimeout = null;\n};\n\nconst handleResizeEvent = () => {\n  const wasL = internalOrientation.landscape;\n  const isL = Utils.isLandscape(false, internalOrientation, bKeyboardOpen);\n  if (wasL !== isL) {\n    handleOrientationChange();\n  }\n  // throttle resize events because most browsers throw one or more resize events per pixel\n  // for every resize event inside the period from 150ms (starting from the first resize event),\n  // we only fire one resize event after this period\n  if (!iResizeTimeout) {\n    iResizeTimeout = window.setTimeout(handleResizeTimeout, 150);\n  }\n};\n\n// re-export everything from the web components device\nexport {\n  isIE,\n  isEdge,\n  isChrome,\n  isFF,\n  isSafari,\n  isMobile,\n  isDesktop,\n  isTablet,\n  isPhone,\n  isAndroid,\n  getOS,\n  getSystem,\n  getBrowser,\n  supportTouch\n} from '@ui5/webcomponents-base/dist/Device';\n// export all support methods\nexport * from './Support';\n// export all media methods\nexport * from './Media';\n// resize events\nexport const getWindowSize = () => {\n  return internalWindowSize;\n};\nexport const attachResizeHandler = (fnFunction: (windowSize: IWindowSize) => void): void => {\n  if (!eventListenersInitialized) {\n    initEventListeners();\n  }\n  eventProvider.attachEvent('resize', fnFunction);\n};\n\nexport const detachResizeHandler = (fnFunction: (windowSize: IWindowSize) => void) => {\n  eventProvider.detachEvent('resize', fnFunction);\n};\n\n// orientation change events\nexport const getOrientation = () => {\n  return internalOrientation;\n};\n\nexport const attachOrientationChangeHandler = (fnFunction: (orientation: IOrientation) => void): void => {\n  if (!eventListenersInitialized) {\n    initEventListeners();\n  }\n  eventProvider.attachEvent('orientation', fnFunction);\n};\n\nexport const detachOrientationChangeHandler = (fnFunction: (orientation: IOrientation) => void) => {\n  eventProvider.detachEvent('orientation', fnFunction);\n};\n"],"names":["supportPointerEvents","window","supportInputPlaceholder","document","createElement","supportWebSocket","isSupported","WebSocket","CLOSING","e","supportMatchMedia","supportMatchMediaListener","matchMedia","supportOrientation","supportRetina","retina","devicePixelRatio","getWindowSize","innerWidth","innerHeight","changeRootCSSClass","sClassName","bRemove","sPrefix","oRoot","documentElement","className","length","aCurrentClasses","split","sNewClasses","forEach","currentClass","indexOf","getQuery","from","to","unit","q","convertToPx","val","s","getComputedStyle","element","currentStyle","x","fontSize","f","parseFloat","matchLegacyBySize","size","width","a","b","isLandscape","bFromOrientationChange","orientation","bKeyboardOpen","supportTouch","getOS","android","landscape","matches","MediaEventProvider","EventProvider","eventProvider","initializedQuerySets","refreshCSSClasses","sSetName","sRangeName","sClassPrefix","getRangeInfo","iRangeIdx","queries","info","names","name","mm","checkQueries","infoOnly","fnMatches","aQueries","i","len","currentquery","noClasses","Logger","warning","handleChange","timer","clearTimeout","setTimeout","mParams","fireEvent","RANGESETS","DEFAULT_RANGE_SET","SAP_STANDARD","DEFAULT_RANGESETS","SAP_3STEPS","points","SAP_4STEPS","SAP_6STEPS","SAP_STANDARD_EXTENDED","hasRangeSet","sName","getCurrentRange","rangeSetName","initRangeSet","isNaN","aRangeBorders","sUnit","aRangeNames","bSuppressClasses","oConfig","toLowerCase","listener","aPoints","query","push","media","addListener","removeRangeSet","removeListener","_eventRegistry","attachMediaHandler","fnFunction","attachEvent","detachMediaHandler","detachEvent","iResizeTimeout","bOrientationChange","bResize","iOrientationTimeout","iClearFlagTimeout","Utils","iWindowWidthOld","iWindowHeightOld","iLastResizeTime","rInputTagRegex","internalWindowSize","height","internalOrientation","portrait","setResizeInfo","setOrientationInfo","clearFlags","eventListenersInitialized","initEventListeners","addEventListener","handleMobileOrientationResizeChange","handleResizeEvent","handleOrientationChange","handleMobileTimeout","getSystem","tablet","ios","version","handleResizeChange","evt","type","test","activeElement","tagName","iWindowWidthNew","iWindowHeightNew","iTime","Date","getTime","handleResizeTimeout","wasL","isL","attachResizeHandler","detachResizeHandler","getOrientation","attachOrientationChangeHandler","detachOrientationChangeHandler"],"mappings":"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"}