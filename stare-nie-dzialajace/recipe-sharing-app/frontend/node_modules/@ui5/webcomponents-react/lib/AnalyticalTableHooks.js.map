{"version":3,"file":"AnalyticalTableHooks.js","sources":["../src/components/AnalyticalTable/util/index.ts","../src/components/AnalyticalTable/pluginHooks/useRowDisableSelection.tsx"],"sourcesContent":["import { defaultOrderByFn } from 'react-table';\n\nexport const orderByFn = (rows, functions, directions) => {\n  const wrapSortFn = (sortFn, index) => {\n    const desc = directions[index] === false || directions[index] === 'desc';\n\n    return (rowA, rowB) => {\n      if (rowA.original?.emptyRow && !rowB.original?.emptyRow) {\n        return desc ? -1 : 1;\n      }\n      if (!rowA.original?.emptyRow && rowB.original?.emptyRow) {\n        return desc ? 1 : -1;\n      }\n      if (rowA.original?.emptyRow && rowB.original?.emptyRow) {\n        return 0;\n      }\n      return sortFn(rowA, rowB);\n    };\n  };\n\n  const wrappedSortfunctions = functions.map(wrapSortFn);\n\n  return defaultOrderByFn(rows, wrappedSortfunctions, directions);\n};\n\n// copied from https://github.com/tannerlinsley/react-table/blob/f97fb98509d0b27cc0bebcf3137872afe4f2809e/src/utils.js#L320-L347 (13. Jan 2021)\nconst reOpenBracket = /\\[/g;\nconst reCloseBracket = /\\]/g;\n\nfunction makePathArray(obj) {\n  return (\n    flattenDeep(obj)\n      // remove all periods in parts\n      .map((d) => String(d).replace('.', '_'))\n      // join parts using period\n      .join('.')\n      // replace brackets with periods\n      .replace(reOpenBracket, '.')\n      .replace(reCloseBracket, '')\n      // split it back out on periods\n      .split('.')\n  );\n}\n\nfunction flattenDeep(arr, newArr = []) {\n  if (!Array.isArray(arr)) {\n    newArr.push(arr);\n  } else {\n    for (let i = 0; i < arr.length; i += 1) {\n      flattenDeep(arr[i], newArr);\n    }\n  }\n  return newArr;\n}\n\n// copied from https://github.com/tannerlinsley/react-table/blob/master/src/utils.js#L169-L191 (13.Jan 2021)\nconst pathObjCache = new Map();\n\nexport function getBy(obj, path, def) {\n  if (!path) {\n    return obj;\n  }\n  const cacheKey = typeof path === 'function' ? path : JSON.stringify(path);\n\n  const pathObj =\n    pathObjCache.get(cacheKey) ||\n    (() => {\n      const pathObj = makePathArray(path);\n      pathObjCache.set(cacheKey, pathObj);\n      return pathObj;\n    })();\n  let val;\n\n  try {\n    val = pathObj.reduce((cursor, pathPart) => {\n      return cursor[pathPart];\n    }, obj);\n  } catch (e) {\n    // continue regardless of error\n  }\n  return typeof val !== 'undefined' ? val : def;\n}\n","import { CheckBox } from '@ui5/webcomponents-react/lib/CheckBox';\nimport { TableSelectionMode } from '@ui5/webcomponents-react/lib/TableSelectionMode';\nimport React from 'react';\nimport { getBy } from '../util';\n\ntype DisableRowSelectionType = string | ((row: Record<any, any>) => boolean);\n\nconst customCheckBoxStyling = {\n  verticalAlign: 'middle'\n};\nconst columns = (columns) => {\n  return columns.map((column) => {\n    if (column.id === '__ui5wcr__internal_selection_column') {\n      return {\n        ...column,\n        Cell: (instance) => {\n          const { webComponentsReactProperties, row } = instance;\n          if (row.disableSelect === true) {\n            if (row.isGrouped && webComponentsReactProperties.selectionMode === TableSelectionMode.SINGLE_SELECT) {\n              return null;\n            }\n            if (webComponentsReactProperties.selectionMode === TableSelectionMode.SINGLE_SELECT) {\n              return <div onClick={undefined} data-name=\"internal_selection_column\" />;\n            }\n            return (\n              <CheckBox\n                {...row.getToggleRowSelectedProps()}\n                disabled\n                style={customCheckBoxStyling}\n                data-name=\"internal_selection_column\"\n              />\n            );\n          }\n          return column.Cell(instance);\n        },\n        Header: () => null\n      };\n    }\n    return column;\n  });\n};\n\n/**\n * A plugin hook for disabling row selection of specific rows.\n * __Note:__ The \"Select All\" checkbox is not available with this hook.\n *\n * @param disableRowSelection - Can be either a `string` or a `function`. `string:` Defines the key in the dataset for disabling rows. If the value of the key is `true`, then the row will not be selectable. `function:` Programmatically disable rows for selection. The function receives the current row as parameter.\n */\nexport const useRowDisableSelection = (disableRowSelection: DisableRowSelectionType) => {\n  const disableRowAccessor =\n    typeof disableRowSelection === 'function'\n      ? disableRowSelection\n      : (d) => getBy(d.original, disableRowSelection, undefined);\n  const getRowProps = (rowProps, { row, instance }) => {\n    const { webComponentsReactProperties } = instance;\n    if (disableRowAccessor(row) === true) {\n      row.disableSelect = true;\n      return { ...rowProps, onClick: undefined, className: webComponentsReactProperties.classes.tr };\n    }\n    return rowProps;\n  };\n\n  const columnDeps = (deps) => {\n    return [...deps, disableRowSelection];\n  };\n\n  const useDisableSelectionRow = (hooks) => {\n    hooks.getRowProps.push(getRowProps);\n    hooks.columns.push(columns);\n    hooks.columnsDeps.push(columnDeps);\n  };\n\n  useDisableSelectionRow.pluginName = 'useRowDisableSelection';\n\n  return useDisableSelectionRow;\n};\n"],"names":["reOpenBracket","reCloseBracket","makePathArray","obj","flattenDeep","map","d","String","replace","join","split","arr","newArr","Array","isArray","push","i","length","pathObjCache","Map","getBy","path","def","cacheKey","JSON","stringify","pathObj","get","set","val","reduce","cursor","pathPart","e","customCheckBoxStyling","verticalAlign","columns","column","id","Cell","instance","webComponentsReactProperties","row","disableSelect","isGrouped","selectionMode","TableSelectionMode","SINGLE_SELECT","undefined","getToggleRowSelectedProps","Header","useRowDisableSelection","disableRowSelection","disableRowAccessor","original","getRowProps","rowProps","onClick","className","classes","tr","columnDeps","deps","useDisableSelectionRow","hooks","columnsDeps","pluginName"],"mappings":"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"}