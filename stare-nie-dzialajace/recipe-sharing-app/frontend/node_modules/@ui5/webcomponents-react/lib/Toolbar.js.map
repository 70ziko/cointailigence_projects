{"version":3,"file":"Toolbar.js","sources":["../src/internal/stopPropagation.ts","../src/components/Toolbar/OverflowPopover.tsx","../src/components/Toolbar/Toolbar.jss.ts","../src/components/Toolbar/index.tsx"],"sourcesContent":["export const stopPropagation = (e) => {\n  e.stopPropagation();\n  e.stopImmediatePropagation();\n};\n","import '@ui5/webcomponents-icons/dist/overflow';\nimport { ButtonDesign } from '@ui5/webcomponents-react/lib/ButtonDesign';\nimport { PlacementType } from '@ui5/webcomponents-react/lib/PlacementType';\nimport { Popover } from '@ui5/webcomponents-react/lib/Popover';\nimport { ToggleButton } from '@ui5/webcomponents-react/lib/ToggleButton';\nimport React, { FC, ReactElement, ReactNode, useCallback, useEffect, useRef, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { Ui5PopoverDomRef } from '../../interfaces/Ui5PopoverDomRef';\nimport { stopPropagation } from '../../internal/stopPropagation';\n\ninterface OverflowPopoverProps {\n  lastVisibleIndex: number;\n  contentClass: string;\n  children: ReactNode;\n}\n\nexport const OverflowPopover: FC<OverflowPopoverProps> = (props: OverflowPopoverProps) => {\n  const { lastVisibleIndex, contentClass, children } = props;\n  const popoverRef = useRef<Ui5PopoverDomRef>();\n  const [pressed, setPressed] = useState(false);\n\n  const handleToggleButtonClick = useCallback(\n    (e) => {\n      if (popoverRef.current) {\n        if (!pressed) {\n          popoverRef.current.openBy(e.target);\n          setPressed(true);\n        } else {\n          popoverRef.current.close();\n        }\n      }\n    },\n    [pressed]\n  );\n\n  useEffect(() => {\n    return () => {\n      if (popoverRef.current) {\n        popoverRef.current.close();\n      }\n    };\n  }, []);\n\n  const handleClose = useCallback(\n    (e) => {\n      stopPropagation(e);\n      setPressed(false);\n    },\n    [setPressed]\n  );\n\n  const renderChildren = useCallback(() => {\n    return React.Children.toArray(\n      (children as ReactElement)?.type === React.Fragment ? (children as ReactElement).props.children : children\n    ).map((item: ReactElement<any>, index) => {\n      if (index > lastVisibleIndex) {\n        if ((item.type as any).displayName === 'ToolbarSeparator') {\n          return React.cloneElement(item, {\n            style: {\n              height: '0.0625rem',\n              margin: '0.375rem 0.1875rem',\n              width: '100%'\n            }\n          });\n        }\n        return item;\n      }\n      return null;\n    });\n  }, [children, lastVisibleIndex]);\n\n  return (\n    <>\n      <ToggleButton\n        design={ButtonDesign.Transparent}\n        icon=\"overflow\"\n        onClick={handleToggleButtonClick}\n        pressed={pressed}\n      />\n      {createPortal(\n        <Popover placementType={PlacementType.Bottom} ref={popoverRef} onAfterClose={handleClose}>\n          <div className={contentClass}>{renderChildren()}</div>\n        </Popover>,\n        document.body\n      )}\n    </>\n  );\n};\n","import { ThemingParameters } from '@ui5/webcomponents-react-base/lib/ThemingParameters';\nimport { CssSizeVariables } from '@ui5/webcomponents-react-base/lib/CssSizeVariables';\n\nexport const styles = {\n  outerContainer: {\n    width: '100%',\n    height: CssSizeVariables.sapWcrToolbarHeight,\n    position: 'relative',\n    overflow: 'hidden',\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    borderBottom: `solid 0.0625rem ${ThemingParameters.sapGroup_TitleBorderColor}`\n  },\n  hasOverflow: {\n    '& $toolbar': {\n      maxWidth: 'calc(100% - 44px)'\n    }\n  },\n  clear: {\n    borderBottom: 'none'\n  },\n  active: {\n    cursor: 'pointer',\n    '&:active': {\n      backgroundColor: ThemingParameters.sapActiveColor\n    },\n    '&:hover': {\n      backgroundColor: ThemingParameters.sapList_Hover_Background\n    }\n  },\n  info: {\n    // This color is most similar to darken(@sapUiBaseColor, 10)\n    backgroundColor: ThemingParameters.sapList_HeaderBorderColor,\n    '&$active': {\n      backgroundColor: ThemingParameters.sapInfobar_Active_Background,\n      '&:active': {\n        backgroundColor: `${ThemingParameters.sapInfobar_Active_Background}`\n      },\n      '&:hover': {\n        backgroundColor: ThemingParameters.sapInfobar_Hover_Background\n      }\n    }\n  },\n  solid: {\n    backgroundColor: ThemingParameters.sapBackgroundColor\n  },\n  transparent: {\n    backgroundColor: ThemingParameters.sapToolbar_Background\n  },\n  toolbar: {\n    width: '100%',\n    '& >:first-child:not(.spacer)': {\n      margin: '0 0.25rem 0 0'\n    },\n    '& >:last-child:not(.spacer)': {\n      margin: '0 0.5rem 0 0.25rem'\n    },\n    '& > *:not(first-child):not(last-child):not(.spacer)': {\n      margin: '0 0.25rem'\n    },\n    display: 'flex',\n    alignItems: 'center',\n    maxWidth: '100%'\n  },\n  overflowButtonContainer: {\n    marginRight: '0.5rem'\n  },\n  popoverContent: {\n    maxWidth: '20rem',\n    padding: CssSizeVariables.sapWcrToolbarPopoverContentPadding,\n    display: 'flex',\n    flexDirection: 'column'\n  }\n};\n","import { createUseStyles } from 'react-jss';\nimport { useConsolidatedRef, useI18nBundle } from '@ui5/webcomponents-react-base/lib/hooks';\nimport { StyleClassHelper } from '@ui5/webcomponents-react-base/lib/StyleClassHelper';\nimport { usePassThroughHtmlProps } from '@ui5/webcomponents-react-base/lib/usePassThroughHtmlProps';\nimport { enrichEventWithDetails } from '@ui5/webcomponents-react-base/lib/Utils';\nimport { SHOW_MORE } from '@ui5/webcomponents-react/dist/assets/i18n/i18n-defaults';\nimport { CommonProps } from '@ui5/webcomponents-react/interfaces/CommonProps';\nimport { ToolbarDesign } from '@ui5/webcomponents-react/lib/ToolbarDesign';\nimport { ToolbarStyle } from '@ui5/webcomponents-react/lib/ToolbarStyle';\nimport React, {\n  cloneElement,\n  createRef,\n  FC,\n  forwardRef,\n  ReactElement,\n  ReactFragment,\n  ReactNode,\n  ReactNodeArray,\n  Ref,\n  RefObject,\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useRef,\n  useState\n} from 'react';\nimport { OverflowPopover } from './OverflowPopover';\nimport { styles } from './Toolbar.jss';\n\nconst useStyles = createUseStyles(styles, { name: 'Toolbar' });\n\nexport interface ToolbarProptypes extends Omit<CommonProps, 'onClick'> {\n  /**\n   * Defines the content of the `Toolbar`.\n   */\n  children?: ReactNode | ReactNodeArray | ReactFragment;\n  /**\n   * Defines the visual style of the `Toolbar`.<br />\n   * <b>Note:</b> The visual styles are theme-dependent.\n   */\n  toolbarStyle?: ToolbarStyle;\n  /**\n   * Defines the `Toolbar` design.<br />\n   * <b>Note:</b> Design settings are theme-dependent.\n   */\n  design?: ToolbarDesign;\n  /**\n   * Indicates that the whole `Toolbar` is clickable. The Press event is fired only if `active` is set to true.\n   */\n  active?: boolean;\n  /**\n   * Fired when the user clicks on the `Toolbar`, if the `active` prop is set to \"true\".\n   */\n  onClick?: (event: CustomEvent) => void;\n}\n\n/**\n * Horizontal container most commonly used to display buttons, labels, selects and various other input controls.\n *\n * The content of the `Toolbar` moves into the overflow area from right to left when the available space is not enough in the visible area of the container.\n * It can be accessed by the user through the overflow button that opens it in a popover.\n */\nconst Toolbar: FC<ToolbarProptypes> = forwardRef((props: ToolbarProptypes, ref: Ref<HTMLDivElement>) => {\n  const { children, toolbarStyle, design, active, style, tooltip, className, onClick, slot } = props;\n  const classes = useStyles(styles);\n  const outerContainer: RefObject<HTMLDivElement> = useConsolidatedRef(ref);\n  const controlMetaData = useRef([]);\n  const [lastVisibleIndex, setLastVisibleIndex] = useState<number>(null);\n\n  const passThroughProps = usePassThroughHtmlProps(props, ['onClick']);\n\n  const i18nBundle = useI18nBundle('@ui5/webcomponents-react');\n\n  const toolbarClasses = StyleClassHelper.of(classes.outerContainer);\n  if (toolbarStyle === ToolbarStyle.Clear) {\n    toolbarClasses.put(classes.clear);\n  }\n  if (active) {\n    toolbarClasses.put(classes.active);\n  }\n  switch (design) {\n    case ToolbarDesign.Solid:\n      toolbarClasses.put(classes.solid);\n      break;\n    case ToolbarDesign.Transparent:\n      toolbarClasses.put(classes.transparent);\n      break;\n    case ToolbarDesign.Info:\n      toolbarClasses.put(classes.info);\n      break;\n    default:\n      break;\n  }\n  toolbarClasses.putIfPresent(className);\n\n  const childrenWithRef = useMemo(() => {\n    controlMetaData.current = [];\n\n    const refactoredChildren = React.Children.toArray(children).map((child, index) => {\n      if ((child as ReactElement).type === React.Fragment) {\n        return (child as ReactElement).props.children.filter(Boolean).map((item, itemIndex: number) => {\n          return cloneElement(item, { key: `.${index}:${itemIndex}` });\n        });\n      }\n      return child;\n    });\n\n    return refactoredChildren.flat().map((item: ReactElement, index) => {\n      const itemRef: RefObject<HTMLDivElement> = createRef();\n\n      controlMetaData.current.push({\n        ref: itemRef\n      });\n\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      if ((item?.type as any)?.displayName === 'ToolbarSpacer') {\n        return item;\n      }\n      return (\n        <div ref={itemRef} key={index}>\n          {item}\n        </div>\n      );\n    });\n  }, [children, controlMetaData]);\n\n  const overflowNeeded =\n    (lastVisibleIndex || lastVisibleIndex === 0) && React.Children.count(childrenWithRef) !== lastVisibleIndex + 1;\n\n  toolbarClasses.putIfPresent(overflowNeeded && classes.hasOverflow);\n\n  const calculateVisibleItems = useCallback(() => {\n    const OVERFLOW_BUTTON_WIDTH = 32 + 8;\n    requestAnimationFrame(() => {\n      if (!outerContainer.current) return;\n      const availableWidth = outerContainer.current.getBoundingClientRect().width;\n      let consumedWidth = 0;\n      let lastIndex = null;\n      let lastFitWidth = 0;\n\n      if (availableWidth - OVERFLOW_BUTTON_WIDTH <= 0) {\n        lastIndex = -1;\n        lastFitWidth = 0;\n      } else {\n        controlMetaData.current.forEach((item, index) => {\n          const currentMeta = controlMetaData.current[index] as { ref: RefObject<HTMLElement> };\n          if (currentMeta && currentMeta.ref && currentMeta.ref.current) {\n            let nextWidth = currentMeta.ref.current.getBoundingClientRect().width;\n            nextWidth += index === 0 || index === controlMetaData.current.length - 1 ? 4 : 8; // first & last element = padding: 4px\n            if (index === controlMetaData.current.length - 1) {\n              if (consumedWidth + nextWidth <= availableWidth - 8) {\n                lastIndex = index;\n                lastFitWidth = consumedWidth + nextWidth;\n              }\n            } else {\n              if (consumedWidth + nextWidth <= availableWidth - OVERFLOW_BUTTON_WIDTH) {\n                lastIndex = index;\n                lastFitWidth = consumedWidth + nextWidth;\n              }\n              if (\n                consumedWidth < availableWidth - OVERFLOW_BUTTON_WIDTH &&\n                consumedWidth + nextWidth >= availableWidth - OVERFLOW_BUTTON_WIDTH\n              ) {\n                lastIndex = index - 1;\n                lastFitWidth = 0;\n              }\n            }\n            consumedWidth += nextWidth;\n          }\n        });\n      }\n      setLastVisibleIndex(lastIndex);\n    });\n  }, [outerContainer.current, controlMetaData.current, setLastVisibleIndex, childrenWithRef, overflowNeeded]);\n\n  const observer = useRef(new ResizeObserver(calculateVisibleItems));\n\n  useEffect(() => {\n    if (outerContainer.current) {\n      observer.current.observe(outerContainer.current);\n    }\n    return () => {\n      observer.current.disconnect();\n    };\n  }, [outerContainer.current]);\n\n  useLayoutEffect(() => {\n    calculateVisibleItems();\n  }, [calculateVisibleItems]);\n\n  const handleToolbarClick = useCallback(\n    (e) => {\n      if (active && typeof onClick === 'function') {\n        onClick(enrichEventWithDetails(e));\n      }\n    },\n    [onClick, active]\n  );\n\n  return (\n    <div\n      title={tooltip}\n      style={style}\n      className={toolbarClasses.className}\n      ref={outerContainer}\n      slot={slot}\n      onClick={handleToolbarClick}\n      {...passThroughProps}\n    >\n      <div className={classes.toolbar}>\n        {overflowNeeded &&\n          React.Children.map(childrenWithRef, (item, index) => {\n            if (index >= lastVisibleIndex + 1) {\n              return React.cloneElement(item as ReactElement, { style: { visibility: 'hidden' } });\n            }\n            return item;\n          })}\n        {!overflowNeeded && childrenWithRef}\n      </div>\n      {overflowNeeded && (\n        <div className={classes.overflowButtonContainer} title={i18nBundle.getText(SHOW_MORE)}>\n          <OverflowPopover lastVisibleIndex={lastVisibleIndex} contentClass={classes.popoverContent}>\n            {React.Children.toArray(children).map((child) => {\n              if ((child as ReactElement).type === React.Fragment) {\n                return (child as ReactElement).props.children;\n              }\n              return child;\n            })}\n          </OverflowPopover>\n        </div>\n      )}\n    </div>\n  );\n});\n\nToolbar.defaultProps = {\n  toolbarStyle: ToolbarStyle.Standard,\n  design: ToolbarDesign.Auto,\n  active: false\n};\n\nToolbar.displayName = 'Toolbar';\nexport { Toolbar };\n"],"names":["stopPropagation","e","stopImmediatePropagation","OverflowPopover","props","lastVisibleIndex","contentClass","children","popoverRef","useRef","useState","pressed","setPressed","handleToggleButtonClick","useCallback","current","openBy","target","close","useEffect","handleClose","renderChildren","React","Children","toArray","type","Fragment","map","item","index","displayName","cloneElement","style","height","margin","width","ButtonDesign","Transparent","createPortal","PlacementType","Bottom","document","body","styles","outerContainer","CssSizeVariables","sapWcrToolbarHeight","position","overflow","display","justifyContent","alignItems","borderBottom","ThemingParameters","sapGroup_TitleBorderColor","hasOverflow","maxWidth","clear","active","cursor","backgroundColor","sapActiveColor","sapList_Hover_Background","info","sapList_HeaderBorderColor","sapInfobar_Active_Background","sapInfobar_Hover_Background","solid","sapBackgroundColor","transparent","sapToolbar_Background","toolbar","overflowButtonContainer","marginRight","popoverContent","padding","sapWcrToolbarPopoverContentPadding","flexDirection","useStyles","createUseStyles","name","Toolbar","forwardRef","ref","toolbarStyle","design","tooltip","className","onClick","slot","classes","useConsolidatedRef","controlMetaData","setLastVisibleIndex","passThroughProps","usePassThroughHtmlProps","i18nBundle","useI18nBundle","toolbarClasses","StyleClassHelper","of","ToolbarStyle","Clear","put","ToolbarDesign","Solid","Info","putIfPresent","childrenWithRef","useMemo","refactoredChildren","child","filter","Boolean","itemIndex","key","flat","itemRef","createRef","push","overflowNeeded","count","calculateVisibleItems","OVERFLOW_BUTTON_WIDTH","requestAnimationFrame","availableWidth","getBoundingClientRect","consumedWidth","lastIndex","forEach","currentMeta","nextWidth","length","observer","ResizeObserver","observe","disconnect","useLayoutEffect","handleToolbarClick","enrichEventWithDetails","visibility","getText","SHOW_MORE","defaultProps","Standard","Auto"],"mappings":"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"}