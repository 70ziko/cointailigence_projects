{"ast":null,"code":"import { getThemeProperties, getRegisteredPackages, isThemeRegistered } from \"../asset-registries/Themes.js\";\nimport createThemePropertiesStyleTag from \"./createThemePropertiesStyleTag.js\";\nimport getThemeDesignerTheme from \"./getThemeDesignerTheme.js\";\nimport { ponyfillNeeded, runPonyfill } from \"./CSSVarsPonyfill.js\";\nimport { fireThemeLoaded } from \"./ThemeLoaded.js\";\nimport { getFeature } from \"../FeaturesRegistry.js\";\nconst BASE_THEME_PACKAGE = \"@ui5/webcomponents-theme-base\";\nconst isThemeBaseRegistered = () => {\n  const registeredPackages = getRegisteredPackages();\n  return registeredPackages.has(BASE_THEME_PACKAGE);\n};\nconst loadThemeBase = async theme => {\n  if (!isThemeBaseRegistered()) {\n    return;\n  }\n  const cssText = await getThemeProperties(BASE_THEME_PACKAGE, theme);\n  createThemePropertiesStyleTag(cssText, BASE_THEME_PACKAGE);\n};\nconst deleteThemeBase = () => {\n  const styleElement = document.head.querySelector(`style[data-ui5-theme-properties=\"${BASE_THEME_PACKAGE}\"]`);\n  if (styleElement) {\n    styleElement.parentElement.removeChild(styleElement);\n  }\n};\nconst loadComponentPackages = async theme => {\n  const registeredPackages = getRegisteredPackages();\n  registeredPackages.forEach(async packageName => {\n    if (packageName === BASE_THEME_PACKAGE) {\n      return;\n    }\n    const cssText = await getThemeProperties(packageName, theme);\n    createThemePropertiesStyleTag(cssText, packageName);\n  });\n};\nconst detectExternalTheme = () => {\n  // If theme designer theme is detected, use this\n  const extTheme = getThemeDesignerTheme();\n  if (extTheme) {\n    return extTheme;\n  }\n\n  // If OpenUI5Support is enabled, try to find out if it loaded variables\n  const OpenUI5Support = getFeature(\"OpenUI5Support\");\n  if (OpenUI5Support) {\n    const varsLoaded = OpenUI5Support.cssVariablesLoaded();\n    if (varsLoaded) {\n      return {\n        themeName: OpenUI5Support.getConfigurationSettingsObject().theme // just themeName, baseThemeName is only relevant for custom themes\n      };\n    }\n  }\n};\n\nconst applyTheme = async theme => {\n  const extTheme = detectExternalTheme();\n\n  // Only load theme_base properties if there is no externally loaded theme, or there is, but it is not being loaded\n  if (!extTheme || theme !== extTheme.themeName) {\n    await loadThemeBase(theme);\n  } else {\n    deleteThemeBase();\n  }\n\n  // Always load component packages properties. For non-registered themes, try with the base theme, if any\n  const packagesTheme = isThemeRegistered(theme) ? theme : extTheme && extTheme.baseThemeName;\n  await loadComponentPackages(packagesTheme);\n\n  // When changing the theme, run the ponyfill immediately\n  if (ponyfillNeeded()) {\n    runPonyfill();\n  }\n  fireThemeLoaded(theme);\n};\nexport default applyTheme;","map":{"version":3,"names":["getThemeProperties","getRegisteredPackages","isThemeRegistered","createThemePropertiesStyleTag","getThemeDesignerTheme","ponyfillNeeded","runPonyfill","fireThemeLoaded","getFeature","BASE_THEME_PACKAGE","isThemeBaseRegistered","registeredPackages","has","loadThemeBase","theme","cssText","deleteThemeBase","styleElement","document","head","querySelector","parentElement","removeChild","loadComponentPackages","forEach","packageName","detectExternalTheme","extTheme","OpenUI5Support","varsLoaded","cssVariablesLoaded","themeName","getConfigurationSettingsObject","applyTheme","packagesTheme","baseThemeName"],"sources":["/home/paris/projekty/haergi/feng/workspace/recipe-sharing-app/frontend/node_modules/@ui5/webcomponents-base/dist/theming/applyTheme.js"],"sourcesContent":["import { getThemeProperties, getRegisteredPackages, isThemeRegistered } from \"../asset-registries/Themes.js\";\nimport createThemePropertiesStyleTag from \"./createThemePropertiesStyleTag.js\";\nimport getThemeDesignerTheme from \"./getThemeDesignerTheme.js\";\nimport { ponyfillNeeded, runPonyfill } from \"./CSSVarsPonyfill.js\";\nimport { fireThemeLoaded } from \"./ThemeLoaded.js\";\nimport { getFeature } from \"../FeaturesRegistry.js\";\n\nconst BASE_THEME_PACKAGE = \"@ui5/webcomponents-theme-base\";\n\nconst isThemeBaseRegistered = () => {\n\tconst registeredPackages = getRegisteredPackages();\n\treturn registeredPackages.has(BASE_THEME_PACKAGE);\n};\n\nconst loadThemeBase = async theme => {\n\tif (!isThemeBaseRegistered()) {\n\t\treturn;\n\t}\n\n\tconst cssText = await getThemeProperties(BASE_THEME_PACKAGE, theme);\n\tcreateThemePropertiesStyleTag(cssText, BASE_THEME_PACKAGE);\n};\n\nconst deleteThemeBase = () => {\n\tconst styleElement = document.head.querySelector(`style[data-ui5-theme-properties=\"${BASE_THEME_PACKAGE}\"]`);\n\tif (styleElement) {\n\t\tstyleElement.parentElement.removeChild(styleElement);\n\t}\n};\n\nconst loadComponentPackages = async theme => {\n\tconst registeredPackages = getRegisteredPackages();\n\tregisteredPackages.forEach(async packageName => {\n\t\tif (packageName === BASE_THEME_PACKAGE) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cssText = await getThemeProperties(packageName, theme);\n\t\tcreateThemePropertiesStyleTag(cssText, packageName);\n\t});\n};\n\nconst detectExternalTheme = () => {\n\t// If theme designer theme is detected, use this\n\tconst extTheme = getThemeDesignerTheme();\n\tif (extTheme) {\n\t\treturn extTheme;\n\t}\n\n\t// If OpenUI5Support is enabled, try to find out if it loaded variables\n\tconst OpenUI5Support = getFeature(\"OpenUI5Support\");\n\tif (OpenUI5Support) {\n\t\tconst varsLoaded = OpenUI5Support.cssVariablesLoaded();\n\t\tif (varsLoaded) {\n\t\t\treturn {\n\t\t\t\tthemeName: OpenUI5Support.getConfigurationSettingsObject().theme, // just themeName, baseThemeName is only relevant for custom themes\n\t\t\t};\n\t\t}\n\t}\n};\n\nconst applyTheme = async theme => {\n\tconst extTheme = detectExternalTheme();\n\n\t// Only load theme_base properties if there is no externally loaded theme, or there is, but it is not being loaded\n\tif (!extTheme || theme !== extTheme.themeName) {\n\t\tawait loadThemeBase(theme);\n\t} else {\n\t\tdeleteThemeBase();\n\t}\n\n\t// Always load component packages properties. For non-registered themes, try with the base theme, if any\n\tconst packagesTheme = isThemeRegistered(theme) ? theme : extTheme && extTheme.baseThemeName;\n\tawait loadComponentPackages(packagesTheme);\n\n\t// When changing the theme, run the ponyfill immediately\n\tif (ponyfillNeeded()) {\n\t\trunPonyfill();\n\t}\n\n\tfireThemeLoaded(theme);\n};\n\nexport default applyTheme;\n"],"mappings":"AAAA,SAASA,kBAAkB,EAAEC,qBAAqB,EAAEC,iBAAiB,QAAQ,+BAA+B;AAC5G,OAAOC,6BAA6B,MAAM,oCAAoC;AAC9E,OAAOC,qBAAqB,MAAM,4BAA4B;AAC9D,SAASC,cAAc,EAAEC,WAAW,QAAQ,sBAAsB;AAClE,SAASC,eAAe,QAAQ,kBAAkB;AAClD,SAASC,UAAU,QAAQ,wBAAwB;AAEnD,MAAMC,kBAAkB,GAAG,+BAA+B;AAE1D,MAAMC,qBAAqB,GAAGA,CAAA,KAAM;EACnC,MAAMC,kBAAkB,GAAGV,qBAAqB,CAAC,CAAC;EAClD,OAAOU,kBAAkB,CAACC,GAAG,CAACH,kBAAkB,CAAC;AAClD,CAAC;AAED,MAAMI,aAAa,GAAG,MAAMC,KAAK,IAAI;EACpC,IAAI,CAACJ,qBAAqB,CAAC,CAAC,EAAE;IAC7B;EACD;EAEA,MAAMK,OAAO,GAAG,MAAMf,kBAAkB,CAACS,kBAAkB,EAAEK,KAAK,CAAC;EACnEX,6BAA6B,CAACY,OAAO,EAAEN,kBAAkB,CAAC;AAC3D,CAAC;AAED,MAAMO,eAAe,GAAGA,CAAA,KAAM;EAC7B,MAAMC,YAAY,GAAGC,QAAQ,CAACC,IAAI,CAACC,aAAa,CAAE,oCAAmCX,kBAAmB,IAAG,CAAC;EAC5G,IAAIQ,YAAY,EAAE;IACjBA,YAAY,CAACI,aAAa,CAACC,WAAW,CAACL,YAAY,CAAC;EACrD;AACD,CAAC;AAED,MAAMM,qBAAqB,GAAG,MAAMT,KAAK,IAAI;EAC5C,MAAMH,kBAAkB,GAAGV,qBAAqB,CAAC,CAAC;EAClDU,kBAAkB,CAACa,OAAO,CAAC,MAAMC,WAAW,IAAI;IAC/C,IAAIA,WAAW,KAAKhB,kBAAkB,EAAE;MACvC;IACD;IAEA,MAAMM,OAAO,GAAG,MAAMf,kBAAkB,CAACyB,WAAW,EAAEX,KAAK,CAAC;IAC5DX,6BAA6B,CAACY,OAAO,EAAEU,WAAW,CAAC;EACpD,CAAC,CAAC;AACH,CAAC;AAED,MAAMC,mBAAmB,GAAGA,CAAA,KAAM;EACjC;EACA,MAAMC,QAAQ,GAAGvB,qBAAqB,CAAC,CAAC;EACxC,IAAIuB,QAAQ,EAAE;IACb,OAAOA,QAAQ;EAChB;;EAEA;EACA,MAAMC,cAAc,GAAGpB,UAAU,CAAC,gBAAgB,CAAC;EACnD,IAAIoB,cAAc,EAAE;IACnB,MAAMC,UAAU,GAAGD,cAAc,CAACE,kBAAkB,CAAC,CAAC;IACtD,IAAID,UAAU,EAAE;MACf,OAAO;QACNE,SAAS,EAAEH,cAAc,CAACI,8BAA8B,CAAC,CAAC,CAAClB,KAAK,CAAE;MACnE,CAAC;IACF;EACD;AACD,CAAC;;AAED,MAAMmB,UAAU,GAAG,MAAMnB,KAAK,IAAI;EACjC,MAAMa,QAAQ,GAAGD,mBAAmB,CAAC,CAAC;;EAEtC;EACA,IAAI,CAACC,QAAQ,IAAIb,KAAK,KAAKa,QAAQ,CAACI,SAAS,EAAE;IAC9C,MAAMlB,aAAa,CAACC,KAAK,CAAC;EAC3B,CAAC,MAAM;IACNE,eAAe,CAAC,CAAC;EAClB;;EAEA;EACA,MAAMkB,aAAa,GAAGhC,iBAAiB,CAACY,KAAK,CAAC,GAAGA,KAAK,GAAGa,QAAQ,IAAIA,QAAQ,CAACQ,aAAa;EAC3F,MAAMZ,qBAAqB,CAACW,aAAa,CAAC;;EAE1C;EACA,IAAI7B,cAAc,CAAC,CAAC,EAAE;IACrBC,WAAW,CAAC,CAAC;EACd;EAEAC,eAAe,CAACO,KAAK,CAAC;AACvB,CAAC;AAED,eAAemB,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}